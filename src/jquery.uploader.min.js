void 0!==typeof jQuery&&function(d){d.fn.imageUploader=function(h){function t(b){if(d(b.target)[0]===a.dropZone[0])return a.onDragLeave(b)}function u(b){if(d(b.target)[0]===a.dropZone[0])return a.onDragEnter(b)}function v(b){b.preventDefault();b.stopPropagation();return a.onDragStart(b)}function w(b){b.preventDefault();b.stopPropagation();return a.onDragEnd(b)}function x(b){b.preventDefault();b.stopPropagation();return a.onDragOver(b)}function y(b){b.preventDefault();b.stopPropagation();q(b.originalEvent.dataTransfer.files);
return a.onDrop(b)}function r(b){a.thumbnails&&(e=a.thumbnails.div.find('[data-upload-status="waiting"]:first'),e.attr("data-upload-status","uploading"),e.append(d('<div class="progress" />').append(d("<div />"))))}function z(b){b.lengthComputable&&(e&&0!=e.length||r(),e&&e.find(".progress > div").width(100*b.loaded/b.total+"%"));return a.onUploadProgress(b)}function A(b){l=!0;var c=null;e&&(e.find(".progress > div").width("100%"),c=e,e=null);a.afterUpload(b.target.response,c);m()}function s(){l=
!0;e=null;a.error("upload failed");m()}function B(){l=!0;e=null;a.error("upload canceled");m()}function C(a){n.push(a);p.push(a);m()}function D(a){for(i in n)if(f=n[i],a.name==f.name&&a.size==f.size&&a.type==f.type)return!0;return!1}function m(){if(l&&0<p.length){file=p.shift();l=!1;var b=file;if(k.upload&&a.beforeUpload()){var c=new FormData;c.append("file",b);k.open("POST",a.url);k.upload.addEventListener("progress",z,!1);k.addEventListener("loadstart",r,!1);k.addEventListener("load",A,!1);k.addEventListener("error",
s,!1);k.addEventListener("abort",B,!1);k.setRequestHeader("X-Requested-With","XMLHttpRequest");k.send(c)}}}function E(b){b.preventDefault();b.stopPropagation();q(b.target.files);return a.onFilesSelected()}function q(b){if(window.File&&window.FileReader&&window.FileList&&window.FormData)for(var c=null,e=0;e<b.length;e++){if(0<a.maxFil­eSize&&file.size>a.maxFileSize)return a.error("the file you are trying to upload is too big");if(!a.allowDuplicate&&D(b[e]))return a.error("the file you are trying to upload has already been sent");
if(a.thumbnails||a.thumbnailReady!=d.noop)a.thumbnails.div.file=b[e],c=new FileReader,c.onload=function(a){F(a.target.result)},c.readAsDataURL(b[e]);try{C(b[e])}catch(G){s()}}else alert("files api not supported")}function F(b){var c=new Image;c.src=b;d(c).hide();var e=d("<div />").attr("data-upload-status","waiting").css({overflow:"hidden",position:"relat­ive"}).append(c);c.onload=function(){var b=a.thumbnails.width,g=a.thumbnails.height,h=c.width/c.height;a.thumbnails.crop&&0<b&&0<g?(e.width(b),e.height(g),
d(c).css("position","absolute"),b/g>h?"zoom"==a.thumbnails.crop?(c.width=b,c.height=b/h,d(c).css("top","-"+parseInt((c.height-g)/2)+"px")):(c.width=g*h,c.height=g,d(c).css("left",parseInt((b-c.width)/2)+"px")):"zoom"==a.thumbnails.crop?(c.height=g,c.width=g*h,d(c).css("left","-"+parseInt((c.width-b)/2)+"px")):(c.width=b,c.height=g/h,d(c).css("top",parseInt((g-c.height)/2)+"px"))):(0<b?c.width=b:0<g&&(c.width=g*h),0<g?c.height=g:0<b&&(c.height=b/h));d(c).css({width:c.width,height:c.height});d(c).show("slow")};
a.thumbnailReady!=d.noop?a.thumbnailReady(e):a.thumbnails.div.append(e)}var a=d.extend({},d.fn.imageUploader.defaults,h);a.dropZone=d(this);var l=!0,p=[],n=[],e=null,k=new XMLHttpRequest;null!=a.dropZone&&(a.dropZone.on("dragstart",v),a.dropZone.on("dragend",w),a.dropZone.on("dragleave",t),a.dropZone.on("dragenter",u),a.dropZone.on("dragover",x),a.dropZone.on("drop",y));null!=a.fileField&&(a.dropZone.on("click",function(){a.fileField.trigger("click")}),"string"==typeof a.fileField&&(a.fileField=d(a.fileField)),
a.fileField.on("change",E),!0==a.hideFileField&&a.fileField.hide());(function(){if(a.thumbnails){if("object"!=typeof a.thumbnails){var b=null;"string"==typeof a.thumbnails&&(b=d(a.thumbnails));a.thumbnails={div:b,width:null,height:null}}"string"==typeof a.thumbnails.div&&(a.thumbnails.div=d(a.thumbnails.div));"object"==typeof a.thumbnails&&void 0==a.thumbnails.div&&(a.thumbnails.div=null);null==a.thumbnails.div&&(a.thumbnails.div=d('<div class="fileUploadThumbnails" />'),a.dropZone.after(a.thumbnails.div))}})();
return this};d.fn.imageUploader.defaults={fileField:null,hideFileField:!0,url:null,thumbnails:{div:null,width:null,height:null},maxFileSize:0,allowDuplicate:!1,thumbna­ilReady:d.noop,onFilesSelected:function(){return!1},onDragStart:function(d){return!1},onDragEnd:function(d){return!1},onDragEnter:function(d){return!1},onDragLeave:function(d){return!1},onDragOver:function(d){return!1},onDrop:function(d){return!1},onUploadProgress:function(d){return!1},beforeUpload:function(){return!0},afterUpload:function(){return!1},
error:function(d){alert(d)},debug:!1}}(jQuery);